# Модуль Payti.Чеки

## Сборка модуля

Под сборкой модуля понимается создание архива, который можно загрузить на Marketplace 1C-Битрикс (https://marketplace.1c-bitrix.ru/) в качестве новой версии модуля.

### Сборка через make

Способ подходит для рабочих мест под Linux.

Выполните команду `make` директории модуля. Если ошибок нет, то будет создан файл `.last_version.tar.gz`

Примечание: если `make` не установлен, то установите `make` через репозиторий. Для debian-подобных систем команда для установки `make` выглядит как: `apt install make`.

### Ручная сборка

Для ручной сборки создайте директорию `.last_version` и скопируйте в неё файлы и директории:

* ./include.php
* /install
* /lang
* /lib

Затем заархивируйте директрию `.last_version` в архив `.last_version.tar.gz` и загрузите в личный кабинет издателя модуля на сайте `1c-bitrix.ru`

Разместите в директории

Дополнительная информация о сборке модуля содержится на сайте для разработчиков [dev.1c-bitrix.ru](https://dev.1c-bitrix.ru/learning/course/index.php?COURSE_ID=101&LESSON_ID=3216&LESSON_PATH=8781.4793.3216)

### Локальный запуск (без сборки)

Под локальным запуском понимается использование модуля без установки через `Marketplace` на сайте (например, интернет-магазине).

Текущее содержимое репозитория разместите в директории `/local/modules/payti.check/` сайта и установите модуль стандартным способом через панель управления.

## Настройка модуля

Отдельной настроки модуль не требует.

Для работы модуля необходимо добавить кассу, обработчик которой предоставляется модулем.

Касса добавляется в разделе Магазин - Кассы - Список касс.

* Добавьте новую кассу и выберите обработчик: `Payti`.
* Выберите **ОФД**: `OFD.RU`
* Укажите **Внешний идентификатор кассы**: (получите в личном кабинете [**payti.ru**](https://payti.ru/))
* Укажите e-mail магазина

Сохраните кассу.

Добавленная касса должна появиться в списке касс. Откройте кассу и продолжите настройки во вкладке `Настройки`:

* Укажите Логин
* Укажите Пароль
* Укажите ИНН организации
* Укажите Адрес интернет-магазина (url)
* Укажите E-mail организации
* Данные о клиенте можно выбрать на свое усмотрение.
* Проверьте коды ставок НДС. Сами ставки НДС, которые поддерживаются магазином, должны быть заданы в разделе Магазин - Настройки - Налоги - Ставки НДС. Настройки ставок распространяются на весь магазин. Будьте внимательны.
* Выберите систему налогообложения.
* Проверьте коды единиц измерения.
* Выберите режим работы кассы: `боевой`

Во вкладке **Настройки ОФД** укажите ИНН и `Сохраните настройки`.

При необходимости укажите ограничения (см. вкладку Ограничения).

После настройки кассы вы сможете вручную создавать чеки через раздел Магазин - Кассы - Чеки за день.

Для автоматической работы вы должны разрешить печать чеков в платежной системе, которую используете а так же проверить настройки печати чеков в разделе Настройки - Настройки продукта - Настройку модулей - Интернет-магазин:

* Секция Настройки печати чеков
* Вкладка Автоматизация процессов
